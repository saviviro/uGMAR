<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Savi Virolainen" />

<meta name="date" content="2017-08-28" />

<title>Introduction to uGMAR</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to uGMAR</h1>
<h4 class="author"><em>Savi Virolainen</em></h4>
<h4 class="date"><em>2017-08-28</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The package uGMAR contains tools to estimate and work with univariate Gaussian Mixture Autoregressive (GMAR) and Student’s t Mixture Autoregressive (StMAR) models. It supports applying general linear constraints to the autoregressive parameters, which enables to consider some other models as well. Besides most likelihood estimation, uGMAR also provides functions for model diagnostics and forecasting for example.</p>
</div>
<div id="parameter-vector" class="section level2">
<h2>Parameter vector</h2>
<p>All the functions in uGMAR require the user to specify the order of AR coefficients <span class="math inline">\(p\)</span> and the number of regimes <span class="math inline">\(M\)</span>. Other important argument regarding the functions in uGMAR is the parameter vector of the model. The form of the parameter vector to work with will depend on specifics of the model: is GMAR or StMAR model considered, are all the AR coefficients restricted to be the same for all regimes and/or are general linear constraints applied to the model? It’s vital to use the correct type of parameter vector accordingly.</p>
<div id="regular-gmar-and-stmar-models" class="section level3">
<h3>Regular GMAR and StMAR models</h3>
<div id="gmar-model" class="section level4">
<h4>GMAR model</h4>
<p>The parameter vector for regular <strong>GMAR</strong> model is size <span class="math inline">\((M(p+3)-1)x1\)</span> vector of form <span class="math display">\[\boldsymbol{\theta}=(\boldsymbol{\upsilon_{1}},...,\boldsymbol{\upsilon_{M}}, \alpha_{1},...,\alpha_{M-1}),\quad where\]</span> <span class="math display">\[\boldsymbol{\upsilon_{m}}=(\phi_{m,0},\boldsymbol{\phi_{m}}, \sigma_{m}^2) \enspace and \enspace \boldsymbol{\phi_{m}}=(\phi_{m,1},...,\phi_{m,p}) ,\quad m=1,...,M.\]</span> Symbol <span class="math inline">\(\phi\)</span> denotes an AR coefficient, <span class="math inline">\(\sigma^2\)</span> component variance and <span class="math inline">\(\alpha\)</span> a mixing weight parameter.</p>
</div>
<div id="stmar-model" class="section level4">
<h4>StMAR model</h4>
<p>In order work with StMAR model, the parameter vector has to be expanded with degrees of freedom parameters. Consequently the parameter vector for regular <strong>StMAR</strong> model is size <span class="math inline">\((M(p+4)-1)x1\)</span> vector of form <span class="math display">\[(\boldsymbol{\theta}, \boldsymbol{\nu}),\quad where \quad \boldsymbol{\nu}=(\nu_{1},...,\nu_{M})\]</span> denotes the degrees of freedom parameters and parameter <span class="math inline">\(\boldsymbol{\theta}\)</span> is as in the case of GMAR model. To ensure the existance of finite second moments the degrees of freedom parameters <span class="math inline">\(\nu_{m}\)</span> are assumed to be larger than <span class="math inline">\(2\)</span>.</p>
<p>If you wish work with StMAR model, be sure to set <code>StMAR=TRUE</code> in the function’s arguments.</p>
</div>
</div>
<div id="restricted-gmar-and-stmar-models" class="section level3">
<h3>Restricted GMAR and StMAR models</h3>
<p>Besides the regular <span class="math inline">\(GMAR\)</span> and <span class="math inline">\(StMAR\)</span> models, this package gives an option to work with restricted models. This means that the AR coefficients <span class="math inline">\(\phi_{m,1},...,\phi_{m,p}\)</span> are restricted to be the same for all regimes <span class="math inline">\(m=1,..,M.\)</span> Structure of the parameter vector is different for restricted and non-restricted models.</p>
<div id="gmar-model-1" class="section level4">
<h4>GMAR model</h4>
<p>The parameter vector for <strong>restricted GMAR</strong> model is size <span class="math inline">\((3M-p+1)x1\)</span> vector of form <span class="math display">\[\boldsymbol{\theta}=(\phi_{1,0},...,\phi_{M,0},\boldsymbol{\phi},\sigma_{1}^2,...,\sigma_{M}^2,\alpha_{1},...,\alpha_{M-1}),  \quad where \quad \boldsymbol{\phi}=(\phi_{1},...,\phi_{p}).\]</span></p>
</div>
<div id="stmar-model-1" class="section level4">
<h4>StMAR model</h4>
<p>The parameter vector for <strong>restricted StMAR</strong> model is then defined by adding the degrees of freedom parameters, yielding size <span class="math inline">\((4M-p+1)x1\)</span> vector of form <span class="math display">\[(\boldsymbol{\theta}, \boldsymbol{\nu}),\quad where \quad \boldsymbol{\nu}=(\nu_{1},...,\nu_{M})\]</span> again denotes the degrees of freedom parameters and parameter <span class="math inline">\(\boldsymbol{\theta}\)</span> is as in the case of GMAR model.</p>
<p>So you will have to work with different kind of parameter vectors depending on wether you work with restricted or non-restricted model. The functions in uGMAR work with the regular non-restricted GMAR model by default. If you want to work with restricted models instead, it’s vital to set <code>restricted=TRUE</code> in the function’s arguments and make sure to use the parameter vector specified for restricted models.</p>
</div>
</div>
<div id="applying-general-linear-constraints-and-how-it-affects-the-parameter-vector" class="section level3">
<h3>Applying general linear constraints and how it affects the parameter vector</h3>
<p>This packages makes it easy to apply linear constraints to the autoregressive parameters of GMAR and StMAR models. uGMAR considers constraints of form <span class="math display">\[\boldsymbol{\phi_{m}}=\boldsymbol{R_{m}\psi_{m}}, \enspace m=1,...,M,\]</span> where <span class="math inline">\(\boldsymbol{R_{m}}\)</span> is known size <span class="math inline">\((pxq_{m})\)</span> constraint matrix of full column rank and <span class="math inline">\(\boldsymbol{\psi_{m}}\)</span> is size <span class="math inline">\(q_{m}x1\)</span> parameter vector.</p>
<p>A special case of this is to constrain some of the AR coefficients to be zero. Another special case is mixture version Heterogenious Autoregressive (HAR) model, which can be obtained by setting <span class="math display">\[\boldsymbol{R_{m}}=\left[{\begin{array}{ccc}
   \boldsymbol{\iota}_{5} &amp; \frac{1}{5}\boldsymbol{1}_{5} &amp; \frac{1}{22}\boldsymbol{1}_{5} \\
   0_{17} &amp; 0_{17} &amp; \frac{1}{22}\boldsymbol{1}_{17} \\
  \end{array}}\right],\]</span> where <span class="math inline">\(\boldsymbol{\iota}_{5}=[1,0,0,0,0]'\)</span> for all regimes <span class="math inline">\(m=1,...,M\)</span> and applying the constraints to GMAR(22,M) model.</p>
<p>In order to apply linear constraints in uGMAR, you simply parametrize the model with vectors <span class="math inline">\(\boldsymbol{\psi_{m}}\)</span> instead of <span class="math inline">\(\boldsymbol{\phi_{m}}\)</span> and provide the constrained matrices <span class="math inline">\(\boldsymbol{R_{m}}\)</span>. And remember to set <code>constraints=TRUE</code> in the function’s arguments. Note that despite the lengths of <span class="math inline">\(\psi_{m}\)</span> the nominal order of AR coefficients is always <span class="math inline">\(p\)</span> for all regimes.</p>
<div id="non-restricted-gmar-and-stmar-models" class="section level4">
<h4>Non-restricted GMAR and StMAR models</h4>
<p>Similarly as in the case of regular GMAR model, the parameter vector for <strong>constrained GMAR</strong> model is of form <span class="math display">\[\boldsymbol{\theta}=(\boldsymbol{\upsilon_{1}},...,\boldsymbol{\upsilon_{M}}, \alpha_{1},...,\alpha_{M-1}),\]</span> but now the vectors <span class="math inline">\(\boldsymbol{\upsilon_{m}}\)</span> are defined using vectors <span class="math inline">\(\boldsymbol{\psi_{m}}\)</span>, that is <span class="math display">\[\boldsymbol{\upsilon_{m}}=(\phi_{m,0},\boldsymbol{\psi_{m}}, \sigma_{m}^2) \enspace and \enspace \boldsymbol{\psi_{m}}=(\psi_{m,1},...,\psi_{m,q_{m}}), \enspace m=1,...,M.\]</span> The user has to also provide a list of constraint matrices <span class="math inline">\(\boldsymbol{R_{m}}\)</span> that satisfy <span class="math inline">\(\boldsymbol{\phi_{m}}=\boldsymbol{R_{m}\psi_{m}}\)</span> for all <span class="math inline">\(m=1,...,M.\)</span></p>
<p>The parameter vector for <strong>constrained StMAR</strong> model is again defined by simply adding the degrees of freedom parameters, that is <span class="math display">\[(\boldsymbol{\theta}, \boldsymbol{\nu}),\quad where \quad \boldsymbol{\nu}=(\nu_{1},...,\nu_{M}),\]</span> and <span class="math inline">\(\boldsymbol{\theta}\)</span> is as in the case of constrained GMAR model.</p>
</div>
<div id="restricted-gmar-and-stmar-models-1" class="section level4">
<h4>Restricted GMAR and StMAR models</h4>
<p>Just as for non-restricted models, the parameter vectors for constrained versions of restricted GMAR and StMAR models are defined by simply replacing vector <span class="math inline">\(\boldsymbol{\phi}\)</span> with vector <span class="math inline">\(\boldsymbol{\psi}\)</span>. Hence the parameter vector for <strong>restricted and constrained GMAR</strong> model is of form <span class="math display">\[\boldsymbol{\theta}=(\phi_{1,0},...,\phi_{M,0},\boldsymbol{\psi},\sigma_{1}^2,...,\sigma_{M}^2,\alpha_{1},...,\alpha_{M-1}),  \quad where \quad \boldsymbol{\psi}=(\psi_{1},...,\psi_{p}).\]</span> The user has to also provide a constraint matrix <span class="math inline">\(\boldsymbol{R}\)</span> that satisfies <span class="math inline">\(\boldsymbol{\phi}=\boldsymbol{R\psi}.\)</span></p>
<p>The parameter vector for <strong>restricted and constrained StMAR</strong> model is then again defined by adding the degrees of freedom parameters, that is <span class="math inline">\((\boldsymbol{\theta}, \boldsymbol{\nu})\)</span> where <span class="math inline">\(\boldsymbol{\nu}=(\nu_{1},...,\nu_{M}).\)</span></p>
</div>
</div>
</div>
<div id="the-most-important-functions-in-ugmar" class="section level2">
<h2>The most important functions in uGMAR</h2>
<p>I thought it would be helpful to make a short list of the most important functions in uGMAR and explain briefly what they do.</p>
<div id="fitgmar" class="section level3">
<h3>fitGMAR</h3>
<p>Probably the most imporant function in this package is <code>fitGMAR</code>, which is used to estimate a GMAR or StMAR model.</p>
<p>The maximum likelihood estimation process is done in two phases. In the first phase <code>fitGMAR</code> uses genetic algorithm to find starting values for gradient based quasi-Newton method, which it then uses in the second phase for final estimations. There is also an option to perform some quantile residual tests for the estimated model to get a quick sense how the model fits to the data.</p>
<p>By default <code>fitGMAR</code> takes use of parallel computing and will perform multiple estimations rounds. Because of multimodality of the log-likelihood function and the randomness associated with the genetic algorithm, it’s expected that some of the estimation rounds may end up in different (local) maximum points. The user should always keep in mind that this function cannot verify whether the found estimates denote the global maximum point or just a local one. A number of estimation rounds is usually required in order to find the most likelihood estimates, and reliability of the results can be increased by increasing the number of estimation rounds. If you wish to see a progress bar during parallel computing, install the suggested package “pbapply”.</p>
<p>The function <code>fitGMAR</code> will return a list containing the estimates, their approximate standard errors, quantile residuals, mixing weights, results from all estimation rounds and lots of other useful stuff.</p>
</div>
<div id="quantileresidualtests" class="section level3">
<h3>quantileResidualTests</h3>
<p>The function <code>quantileResidualTests</code> performs quantile residual tests for the specified GMAR or StMAR model, testing normality, autocorrelation and conditional heteroscedasticity. The tests are based on the paper by <em>Kalliovirta (2012)</em>.</p>
<p><code>quantileResidualTests</code> returns a list of data frames containing the test results for <code>$normality</code>, <code>$autocorrelation</code> and <code>$cond.heteroscedasticity</code> of the quantile residuals. Consider installing the suggested package “gsl” for faster evaluations of quantile residuals in the cases of StMAR models.</p>
</div>
<div id="plotgmar" class="section level3">
<h3>plotGMAR</h3>
<p>The function <code>plotGMAR</code> is designed to give an easy access to quantile residual based model diagnostics.</p>
<p>It plots quantile residual time series, QQ-plot, autocorrelation function and squared quantile residual autocorrelation function. It also plots the individual statistics associated with the quantile residual tests with their approximate 95% critical bounds. Calculating the critical bounds will take a while, so you might want to set <code>approxBounds=FALSE</code> in the function´s arguments in order to take a look at the quantile residuals faster.</p>
</div>
<div id="simulategmar" class="section level3">
<h3>simulateGMAR</h3>
<p>The function <code>simulateGMAR</code> can be used to simulate values from a specified GMAR or StMAR process.</p>
<p>By default <code>simulateGMAR</code> will simulate initial values from the process’s stationary distribution, but you can set your own inital values you wish to. <code>simulateGMAR</code> will return a list containing the simulated sample, information which component model was used to generate which sample and the corresponding mixing weights.</p>
</div>
<div id="forecastgmar" class="section level3">
<h3>forecastGMAR</h3>
<p>The function <code>forecastGMAR</code> is used to forecast a specified GMAR or StMAR process by simulation. It uses the given data to simulate the process’s possible future values and will then base the prediction on the sample median (or mean if set <code>useMean=TRUE</code>) and confidence intervals on the empirical fractiles.</p>
<p>By default <code>forecastGMAR</code> will then plot the prediction and the confidence intervals along with the data. Note that if the data is in the form of univariate time series object, the plots will take advantage of the timespan and frequency provided. <code>forecastGMAR</code> will return a data frame containing the prediction and confidence intervals.</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li>Kalliovirta L., Meitz M. and Saikkonen P. (2015) Gaussian Mixture Autoregressive model for univariate time series. <em>Journal of Time Series Analysis</em>, <strong>36</strong>, 247-266.</li>
<li>Kalliovirta L. (2012) Misspecification tests based on quantile residuals. <em>The Econometrics Journal</em>, <strong>15</strong>, 358-393.</li>
<li>References regarding StMAR model and general linear constraints will be updated after they are published.</li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
# Add regime densities if desired
myscale <- 6000
lines(y=x, x=myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(y=x, x=myscale*alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(y=x, x=myscale*alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=4, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
# Add regime densities if desired
myscale <- 4000
lines(y=x, x=myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(y=x, x=myscale*alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(y=x, x=myscale*alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=4, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
# Add regime densities if desired
myscale <- 3000
lines(y=x, x=myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(y=x, x=myscale*alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(y=x, x=myscale*alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=4, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
lines(y=x, x=c(rep(1954, NA), myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1]))=, type="l", lty=3, col=cols[1])
lines(y=x, x=c(rep(1954, NA), myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(y=x, x=c(rep(1954, NA), myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1]))), type="l", lty=3, col=cols[1])
lines(y=x, x=c(rep(1954, NA), myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1]))), type="l", lty=3, col=cols[1])
lines(y=x, x=c(rep(NA, 1954), myscale*alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1]))), type="l", lty=3, col=cols[1])
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=4, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), labels=NA, lty=1, font=1, cex.axis=1)
# Flipped
plot(y=density(YF)$x, x=density(YF)$y, xlim=c(0, 2), main="", ylab="", xlab="", type="l")
lines(y=x, x=alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(y=x, x=alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(y=x, x=alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
lines(y=x, x=mod53_dens(x), type="l", lty=2, col="red4")
lines(YF)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
?axis
axis(side=2, pos=2, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=1, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=0, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=NA, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=1954, outer=TRUE, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=2, pos=1954, outer=TRUE, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=2, padj=1, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, padj=0, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, hadj=0, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=2, hadj=0, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, hadj=1, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, hadj=-1, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=2, hadj=-1, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=2, hadj=-5, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
?par
axis(side=2, pos=-5, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8)
axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
?segments
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1954.5, 5), x1=rep(1956, 5), y0=seq(0, 20, by=5), col="slateblue")
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1954, 5), x1=rep(1956, 5), y0=seq(0, 20, by=5), col="slateblue")
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1956, 5), y0=seq(0, 20, by=5), col="slateblue")
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1954, 5), y0=seq(0, 20, by=5), col="slateblue")
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
?text
?mtext
text(x=rep(1953, 5), y=seq(0, 20, by=5), col="slateblue", labels=y)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1953, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1955, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE)
?layout
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
#par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
#par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
par(las=1)
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1955, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
# mod53 density plot
x <- seq(-6, 2, by=0.01)
alphas <- pick_alphas(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
means <- get_regime_means(mod53)
vars <- get_regime_vars(mod53)
dfs <- pick_dfs(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
plot(density(YF), ylim=c(0, 2), main="", ylab="", xlab="")
lines(x=x, y=alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(x=x, y=alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(x=x, y=alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
lines(x=x, y=mod53_dens(x), type="l", lty=2, col="red4")
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
#par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
par(las=1, mar=c(2.1, 2.6, 1.1, 0.1))
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1955, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), labels=NA, lty=1, font=1, cex.axis=1)
# mod53 density plot
x <- seq(-6, 2, by=0.01)
alphas <- pick_alphas(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
means <- get_regime_means(mod53)
vars <- get_regime_vars(mod53)
dfs <- pick_dfs(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
plot(density(YF), ylim=c(0, 2), main="", ylab="", xlab="")
lines(x=x, y=alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(x=x, y=alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(x=x, y=alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
lines(x=x, y=mod53_dens(x), type="l", lty=2, col="red4")
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
#par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
par(las=1, mar=c(2.1, 2.6, 1.1, 1.1))
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1955, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), labels=NA, lty=1, font=1, cex.axis=1)
# mod53 density plot
x <- seq(-6, 2, by=0.01)
alphas <- pick_alphas(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
means <- get_regime_means(mod53)
vars <- get_regime_vars(mod53)
dfs <- pick_dfs(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
plot(density(YF), ylim=c(0, 2), main="", ylab="", xlab="")
lines(x=x, y=alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(x=x, y=alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(x=x, y=alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
lines(x=x, y=mod53_dens(x), type="l", lty=2, col="red4")
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
#par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
par(las=1, mar=c(2.1, 2.6, 1.1, 1.1))
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1955, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), labels=NA, lty=1, font=1, cex.axis=1)
# mod53 density plot
x <- seq(-6, 2, by=0.01)
alphas <- pick_alphas(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
means <- get_regime_means(mod53)
vars <- get_regime_vars(mod53)
dfs <- pick_dfs(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
plot(density(YF), ylim=c(0, 2), main="", ylab="", xlab="", cex.axis=0.8, font.axis=2)
lines(x=x, y=alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(x=x, y=alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(x=x, y=alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
lines(x=x, y=mod53_dens(x), type="l", lty=2, col="red4")
save.image("\\\\ad.helsinki.fi/home/s/saviviro/Desktop/GSTMARartikkeli/empexample_env_vara")
mods2 <- lapply(1:6, function(i1) fitGSMAR(YF, p=i1, M=2, model="StMAR", conditional=FALSE, ncalls=100, ncores=4, seeds=1:100)) # AIC p=6, HQIC p=5, BIC p=5
save.image("\\\\ad.helsinki.fi/home/s/saviviro/Desktop/GSTMARartikkeli/empexample_env")
mods3 <- lapply(1:6, function(i1) fitGSMAR(YF, p=i1, M=3, model="StMAR", conditional=FALSE, ncalls=100, ncores=4, seeds=1:100)) # AIC p=3, HQIC p=3, BIC p=3
save.image("\\\\ad.helsinki.fi/home/s/saviviro/Desktop/GSTMARartikkeli/empexample_env")
gmars4 <- lapply(1:6, function(i1) fitGSMAR(YF, p=i1, M=4, model="GMAR", conditional=FALSE, ncalls=100, ncores=4, seeds=1:100))
save.image("\\\\ad.helsinki.fi/home/s/saviviro/Desktop/GSTMARartikkeli/empexample_env")
gmars4[[3]]$IC
plot(gmars4[[3]])
diagnosticPlot(gmars4[[3]])
diagnosticPlot(gmars4[[4]])
diagnosticPlot(gmars4[[6]])
plot(gmars4[[6]])
quantileResidualTests(gmars4[[6]])
length(gmars4[[6]]$params)
length(gmars4[[3]]$params)
quantileResidualTests(gmars4[[3]])
quantileResidualTests(gmars4[[5]])
gmars4[[5]]$IC
plot(gmars4[[5]])
summary(gmars4[[5]])
diagnosticPlot(gmars4[[5]])
length(gmars4[[5]]$params)
length(mod53$params)
sapply(1:6, function(i1) gmars4[[i1]]$loglik) # loglik p=6 (249.7902), AIC p=6 (-447.5804), HQIC p=2 (-427.6772), BIC p=2 (-387.5229)
sapply(1:6, function(i1) gmars4[[i1]]$IC) # loglik p=5 (317.0821), AIC p=6 (-447.5804), HQIC p=2 (-427.6772), BIC p=2 (-387.5229)
mod54g <- gmars4[[5]]
get_foc(mod54g)
get_soc(mod54g)
qrt53g <- quantileResidualTests(gmars4[[5]], lagsAC=c(1, 3, 6, 12), nsimu=20000)
qrt53g <- quantileResidualTests(gmars4[[5]], lagsAC=c(1, 3, 6, 12), nsimu=20000)
qrt54g <- rt53g
qrt54g <- qrt53g
# Choose the best M=2 model:
sapply(1:6, function(i1) mods2[[i1]]$IC) # max: loglik p=6 (312.5191), AIC p=6 (-587.0383), HQIC p=5 (-553.8559), BIC p=5 (-505.0972)
summary(mods2[[6]], digits=6) # Check p=6 estimate
get_foc(mods2[[6]]); get_soc(mods2[[6]]) # FOC ok, SOC ok
plot(mods2[[6]])
summary(mods2[[5]], digits=6) # Check p=5 estimate: overly large degrees of freedom
mod52 <- stmar_to_gstmar(mods2[[5]]) # Swap to G-StMAR model
get_foc(mod52); get_soc(mod52) # SOC ok. FOC ok but some large values; however, profile log-likelihoods confirm approximate maximum
plot(mod52)
# Prof-log-lik
par(mar=c(2.1, 1, 1, 1), mfrow=c(4, 4))
for(i1 in 1:16) {
pars <- mod52$params
range <- abs(0.02*pars[i1])
vals <- seq(from=pars[i1] - range, to=pars[i1] + range, length.out=100)
logliks <- vapply(vals, function(new_val) {
new_pars <- pars
new_pars[i1] <- new_val
loglikelihood_int(data=YF, p=5, M=c(1, 1), params=new_pars, model="G-StMAR", conditional=FALSE, boundaries=TRUE, minval=NA)
}, numeric(1))
plot(x=vals, y=logliks, type="l"); abline(v=pars[i1], col="red")
}
sapply(1:6, function(i1) mods3[[i1]]$IC) #IC mins are: AIC p=6 (-604.466), HQIC p=6 (-552.486), BIC p=5 (-471.0669)
summary(mods3[[6]], digits=6) # Check first the p=6 estimate: third regime really close the border of the stationarity region
get_foc(mods3[[6]]); get_soc(mods3[[6]])  # Large values in FOC, SOC ok.
plot(mods3[[6]]) # Second regime seems a bit problematic. This model is similar to the 2-regime model but with additional
mods3[[6]]
length(mods3[[6]]$params)
#########################################################
######## Profile log-likelihoods ########################
#old_par <- par()
par(mar=c(2.1, 1, 1, 1), mfrow=c(6, 5))
p <- 6
M <- 3#c(1, 2)
for(i1 in 1:29) {
pars <- mods3[[p]]$params
#pars <- mod53$params
range <- abs(0.02*pars[i1])
vals <- seq(from=pars[i1] - range, to=pars[i1] + range, length.out=100)
logliks <- vapply(vals, function(new_val) {
new_pars <- pars
new_pars[i1] <- new_val
loglikelihood_int(data=YF, p=p, M=M, params=new_pars, model="G-StMAR", conditional=FALSE, boundaries=TRUE, minval=NA)
}, numeric(1))
plot(x=vals, y=logliks, type="l"); abline(v=pars[i1], col="red")
}
for(i1 in 1:29) {
pars <- mods3[[p]]$params
#pars <- mod53$params
range <- abs(0.02*pars[i1])
vals <- seq(from=pars[i1] - range, to=pars[i1] + range, length.out=100)
logliks <- vapply(vals, function(new_val) {
new_pars <- pars
new_pars[i1] <- new_val
loglikelihood_int(data=YF, p=p, M=M, params=new_pars, model="StMAR", conditional=FALSE, boundaries=TRUE, minval=NA)
}, numeric(1))
plot(x=vals, y=logliks, type="l"); abline(v=pars[i1], col="red")
}
# Check the second highest log-likelihood:
order(mods3[[6]]$all_logliks, decreasing=TRUE) # 99th:th estimation round
mod63_2 <- alt_gsmar(mods3[[6]], 99)
summary(mod63_2, digits=6) # 3rd regime near boundary of stationarity region
plot(mod63_2g) # For the same reasons as in the previous case, this estimate is not an appropriate solution for the model
plot(mod63_2) # For the same reasons as in the previous case, this estimate is not an appropriate solution for the model
# Check the third highest log-likelihood
order(mods3[[6]]$all_logliks, decreasing=TRUE) # 31:th estimation round has the third best loglik
mod63_3 <- alt_gsmar(mods3[[6]], 31)
summary(mod63_3, digits=6) # The second regime seems to have 4 close-to-unit-roots: again this is not
plot(mod63_3) # an appropriate solution for the model.
mod63_3$IC # The AIC is -591.6097 , HQIC -539.6298 and BIC -456.453 which is worse than in the p=5 case,
sapply(1:6, function(i1) mods3[[i1]]$IC) #IC mins are: AIC p=6 (-604.466), HQIC p=6 (-552.486), BIC p=5 (-471.0667)
# Check the fourth highest log-likelihood
order(mods3[[6]]$all_logliks, decreasing=TRUE) # 31:th estimation round has the third best loglik
mod63_4 <- alt_gsmar(mods3[[6]], 66)
summary(mod63_4, digits=6) # The second regime seems to have 4 close-to-unit-roots: again this is not
get_foc(mod63_4)
get_soc(mod63_4)
plot(mod63_4)
mod63_4$IC
mods3[[5]]$IC
# Check the p=5 case:
summary(mods3[[5]], digits=6) # No unit roots, high degree of freedom and small variance in the third regime.
mod53 <- stmar_to_gstmar(mods3[[5]]) # Swap to G-StMAR model
get_foc(mod53); get_soc(mod53) # SOC ok, FOC has large value for the small var param, but profile log-likelihoods confirm that the
# the estimate points a maximum point and the high FOC value is just due to error in the numerical approximation.
par(mar=c(2.1, 1, 1, 1), mfrow=c(6, 5))
for(i1 in 1:29) {
pars <- mod53$params
range <- abs(0.02*pars[i1])
vals <- seq(from=pars[i1] - range, to=pars[i1] + range, length.out=100)
logliks <- vapply(vals, function(new_val) {
new_pars <- pars
new_pars[i1] <- new_val
loglikelihood_int(data=YF, p=5, M=c(1, 2), params=new_pars, model="G-StMAR", conditional=FALSE, boundaries=TRUE, minval=NA)
}, numeric(1))
plot(x=vals, y=logliks, type="l"); abline(v=pars[i1], col="red")
}
length(pars)
# the estimate points a maximum point and the high FOC value is just due to error in the numerical approximation.
par(mar=c(2.1, 1, 1, 1), mfrow=c(5, 5))
for(i1 in 1:25) {
pars <- mod53$params
range <- abs(0.02*pars[i1])
vals <- seq(from=pars[i1] - range, to=pars[i1] + range, length.out=100)
logliks <- vapply(vals, function(new_val) {
new_pars <- pars
new_pars[i1] <- new_val
loglikelihood_int(data=YF, p=5, M=c(1, 2), params=new_pars, model="G-StMAR", conditional=FALSE, boundaries=TRUE, minval=NA)
}, numeric(1))
plot(x=vals, y=logliks, type="l"); abline(v=pars[i1], col="red")
}
plot(YF)
par(old_par)
plot(YF)
pacf(YF)
pacf(YF^2)
loks <- vapply(1:24, function(i1) mods1[[i1]]$loglik, numeric(1))
aics <- vapply(1:24, function(i1) mods1[[i1]]$IC$AIC, numeric(1))
hqics <- vapply(1:24, function(i1) mods1[[i1]]$IC$HQIC, numeric(1))
bics <- vapply(1:24, function(i1) mods1[[i1]]$IC$BIC, numeric(1))
plot(loks, type="b", ylim=c(150, 550))
lines(-aics, type="b", col="red")
lines(-hqics, type="b", col="blue")
lines(-bics, type="b", col="green")
abline(v=6)
qrt61
diagnosticPlot(mods1[[6]])
qrt61 <- quantileResidualTests(YF61, lagsAC=c(1, 3, 6, 12), nsimu=2000)
summary(mods2[[6]], digits=6) # Check p=6 estimate
summary(mods2[[6]], digits=2) # Check p=6 estimate
summary(mods2[[5]], digits=2) # Check p=6 estimate
plot(mod52)
diagnosticPlot(mod52)
qrt52
mods2[[5]]
summary(mods3[[6]], digits=2) # Check first the p=6 estimate: third regime really close the border of the stationarity region
plot(mods3[[6]]) # Second regime seems problematic. This model is similar to the 2-regime model but with additional
plot(mod63_4)
layout(mat=matrix(c(1, 3, 2, 3), nrow=2, byrow=TRUE), widths=c(2, 1))
#par(mar=c(2.1, 2.6, 1.1, 2.6), mfrow=c(2, 1), las=1)
par(las=1, mar=c(2.1, 2.6, 1.1, 1.1))
plot(FEDFUNDS, col="slateblue", lty=3, main="", ylab="", xlab="", xaxt="n", yaxt="n", ylim=c(0, 20))
#axis(side=2, pos=1954, col.axis="slateblue", col.ticks="slateblue", col="slateblue", lty=1, font=2, cex.axis=0.8, xaxt="n")
segments(x0=rep(1950, 5), x1=rep(1953, 5), y0=seq(0, 20, by=5), col="slateblue")
text(x=rep(1955, 5), y=seq(0, 20, by=5), col="slateblue", labels=seq(0, 20, by=5), font=2, cex=0.8)
#axis(side=4, col.axis="coral", col.ticks="coral", col="slateblue", lty=3, font=2, cex.axis=0.8)
lines(TB3MS, col="coral", lty=3)
#abline(h=0, col="grey", lty=1)
par(new=TRUE)
plot(YF, type="n", main="", ylab="", xlab="", xaxt="n", yaxt="n")
abline(h=0, col="grey", lty=2)
lines(YF)
axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), lty=1, font=1, cex.axis=1)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#par(new=TRUE)
cols <- c("red3", "green3", "blue3") # coral, slateblue, orange, springgreen4
plot(ts(c(rep(NA, times=5), mod53$mixing_weights[,1]), start=c(1954, 7), frequency=12), type="l", col=cols[1], ylim=c(0, 1), lty=2, ylab=NA, xaxt="n", yaxt="n")
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,2]), start=c(1954, 7), frequency=12), col=cols[2], lty=2)
lines(ts(c(rep(NA, times=5), mod53$mixing_weights[,3]), start=c(1954, 7), frequency=12), col=cols[3], lty=2)
axis(side=2, col.axis="black", col.ticks="black", col="black", lty=1, font=2, cex.axis=0.8)
#axis(side=1, col.axis="black", col.ticks="black", col="black", at=seq(1960, 2020, by=10), labels=NA, lty=1, font=1, cex.axis=1)
# LAITA DENSITYN TICKIT KUVAN SISÄÄN TMS? JA SÄÄDÄ SLATEBLUE TICKKIEN KOKO?
# mod53 density plot
x <- seq(-6, 2, by=0.01)
alphas <- pick_alphas(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
means <- get_regime_means(mod53)
vars <- get_regime_vars(mod53)
dfs <- pick_dfs(p=5, M=c(1, 2), params=mod53$params, model="G-StMAR")
plot(density(YF), ylim=c(0, 2), main="", ylab="", xlab="", cex.axis=0.8, font.axis=2)
lines(x=x, y=alphas[1]*dnorm(x, mean=means[1], sd=sqrt(vars[1])), type="l", lty=3, col=cols[1])
lines(x=x, y=alphas[2]*my_dt(x, mean=means[2], var=vars[2], df=dfs[1]), type="l", lty=3, col=cols[2])
lines(x=x, y=alphas[3]*my_dt(x, mean=means[3], var=vars[3], df=dfs[2]), type="l", lty=3, col=cols[3])
lines(x=x, y=mod53_dens(x), type="l", lty=2, col="red4")
1

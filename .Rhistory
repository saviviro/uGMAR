Q
Q
Q
aps1 <- lapply(1:6, function(i1) fitGSMAR(APPLE, p=i1, M=1, model="StMAR", conditional=FALSE, ncalls=2, ncores=2))
plot(density(APPLE))
sapply(1:6, function(i1) aps1[[i1]]$loglik)
sapply(1:6, function(i1) aps1[[i1]]$IC)
diagnosticPlot(aps1[[1]])
ap12 <- fitGSMAR(APPLE, p=1, M=2, model="StMAR", conditional=FALSE, ncalls=16, ncores=2, seeds=1:16)
ap12
diagnosticPlot(ap12)
plot(ap12)
ap13 <- fitGSMAR(APPLE, p=1, M=3, model="StMAR", conditional=FALSE, ncalls=16, ncores=2, seeds=1:16)
ap13
plot(ap13)
diagnosticPlot(ap13)
ap22 <- fitGSMAR(APPLE, p=2, M=2, model="StMAR", conditional=FALSE, ncalls=12, ncores=2, seeds=1:12)
ap22
plot(ap22)
diagnosticPlot(ap22)
gs32 <- fitGSMAR(GS, p=3, M=2, model="StMAR", ncalls=16, ncores=2, seeds=1:16)
gs32
plot(gs32)
diagnosticPlot(gs32)
quantileResidualTests(gs32)
gs32$IC
gs33$IC
gs33g <- fitGSMAR(GS, p=3, M=c(1, 2), model="G-StMAR", ncalls=20, ncores=2, seeds=1:20)
gs33g
gs33gg <- stmar_to_gstmar(gs33g)
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
gs33g
plot(gs33g)
gs33g$IC
gs33$IC
gs33$loglik
gs33g$loglik
diagnosticPlot(gs33g)
# loglik ylläolevalla parempi kuin gs33:sella eli gs33 huonosti estimoitunut
gs33_2 <- fitGSMAR(GS, p=3, M=3, model="StMAR", ncalls=8, ncores=2, seeds=17:24)
ggs33_2
gs33_2
gs33_2$loglik
gs33g$loglik
gs33g$params
gs33g
gs33g$params
c(gs33g$params[1:17], 300, 8, 300)
gs33_3 <- fitGSMAR(GS, p=3, M=3, model="StMAR", ncalls=2, ncores=2, initpop=list(c(gs33g$params[1:17], 300, 8, 300)))
gs33_3
gs33_3$loglik
gs33g$loglik
plot(gs33_3)
diagnosticPlot(gs33_3)
gs33_3g <- stmar_to_gstmar(gs33_3)
quantileResidualTests(gs33_3g)
Q
a
install.packages("gsl")
install.packages("gsl")
quantileResidualTests(gs33_3g)
library(forecast)
arim <- forecast::auto.arima(IBM, d=0, seasonal=FALSE, stationary=TRUE, ic="aic",
stepwise=FALSE, approximation=FALSE, trace=TRUE)
gs1 <- lapply(1:6, function(i1) fitGSMAR(GS, p=i1, M=1, model="StMAR", conditional=FALSE, ncalls=2, ncores=2))
sapply(1:6, function(i1) gs1[[i1]]$loglik)
sapply(1:6, function(i1) gs1[[i1]]$IC)
diagnosticPlot(gs1[[3]])
pacf(GS)
pacf(GS^2)
quantileResidualTests(gs1[[3]])
arim <- forecast::auto.arima(GS, d=0, seasonal=FALSE, stationary=TRUE, ic="aic",
stepwise=FALSE, approximation=FALSE, trace=TRUE,
max.p=6, max.q=6, max.order=7)
arim <- forecast::auto.arima(GS, d=0, seasonal=FALSE, stationary=TRUE, ic="aic",
stepwise=FALSE, approximation=FALSE, trace=TRUE,
max.p=6, max.q=6, max.order=12)
arim
?Arima
gs33_3g$loglik
newmod <- Arima(GS, model=arim)
newmod
forecast(newmod)
?forecast
class(arim)
?forecast.arima
?forecast.Arima
forecast(newmod, h=2, level=0.95)
tmp <- forecast(newmod, h=2, level=0.95)
tmp$mean
tmp$mean[1]
GSrestlog <- log(GSrest)
gs33_3$loglik
gs33_3$loglik  > gs33$loglik
GSrest <- readr::read_csv("/home/savi/Downloads/VXGSCLSrest.csv")
GSrest <- as.numeric(GSrest[[2]])
GSrest <- ts(GSrest[!is.na(GSrest)], start=c(2010, 126), frequency=252) # Approximative start day
GSrest <- readr::read_csv("/home/savi/Downloads/VXGSCLSrest.csv")
GSrest <- as.numeric(GSrest[[2]])
SGrest <- GSrest[!is.na(GSrest)]
plot(GSrest, type="l")
plot(GS)
GSrest
GSrest <- readr::read_csv("/home/savi/Downloads/VXGSCLSrest.csv")
GSrest <- as.numeric(GSrest[[2]])
GSrest <- GSrest[!is.na(GSrest)] # on jo log!
plot(GSrest, type="l")
acf(GSerst)
acf(GSrest)
pacf(GSrest)
pacf(GSrest^2)
GSrest
GS
fcast33 <- vector(mode="list", length=length(GSrest))
fcast33 <- vector(mode="list", length=length(GSrest))
fcastarim <- vector(mode="list", length=length(GSrest))
tmpmodel <- gs33_3g
gs33_3g$loglik
tmpmodel
arim
length(GSrest)
arim
arimamodel <- arim
cast33 <- vector(mode="list", length=length(GSrest))
fcastarim <- vector(mode="list", length=length(GSrest))
tmpmodel <- gs33_3g
arimamodel <- arim
for(i1 in 1:length(GSrest)) {
fcast33[[i1]] <- predict(tmpmodel, n_ahead=2, nsimu=500, pi=0.95, pred_type="median",
pi_type="upper", plotRes=FALSE)
fcastarim[[i1]] <- forecast(arimamodel, h=2, level=0.95)
olddat <- tmpmodel$data
newdat <- c(olddat, GSrest[i1])
tmpmodel <- add_data(newdat, tmpmodel, calc_qresiduals=FALSE, calc_cond_moments=FALSE, calc_std_errors=FALSE)
arimamodel <- Arima(newdata, model=arimamodel)
print(i1)
}
fcast33 <- vector(mode="list", length=length(GSrest))
fcastarim <- vector(mode="list", length=length(GSrest))
tmpmodel <- gs33_3g
arimamodel <- arim
for(i1 in 1:length(GSrest)) {
fcast33[[i1]] <- predict(tmpmodel, n_ahead=2, nsimu=500, pi=0.95, pred_type="median",
pi_type="upper", plotRes=FALSE)
fcastarim[[i1]] <- forecast(arimamodel, h=2, level=0.95)
olddat <- tmpmodel$data
newdat <- c(olddat, GSrest[i1])
tmpmodel <- add_data(newdat, tmpmodel, calc_qresiduals=FALSE, calc_cond_moments=FALSE, calc_std_errors=FALSE)
arimamodel <- Arima(newdat, model=arimamodel)
print(i1)
}
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
plot(fores33, type="l")
fcastarim[[¡]]
fcastarim[[1]]
fcastarim[[1]]$mean
fcastarim[[1]]$mean[1]
save.image("/home/savi/Desktop/uGMARartikkeli/repro_env.gz")
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[1])
plot(foresarim, type="l")
calc_mse <- function(pred) crossprod(exp(pred) - exp(GSrest))
calc_mse(fores33)
calc_mse(foresarim)
5368.137/5490.351
plot(GSrest[1:252], type="l")
calc_mse <- function(pred) crossprod(exp(pred)[1:252] - exp(GSrest)[1:252])
calc_mse(fores33)
calc_mse(foresarim)
635.6065/640.5912
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[2])
calc_mse <- function(pred) crossprod(exp(pred)[-length(pred)] - exp(GSrest)[-1])
calc_mse(fores33)
calc_mse(foresarim)
7614.207/7680.681
fcast33[[1]]
fcast33[[1]]$pred_ints
fcast33[[1]]$pred_ints[1]
ints33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred_ints[1])
lines(ints33, col="red", lty=2)
sum(exp(ints33) < exp(GSrest))/length(GSrest)
sum(exp(ints33) > exp(GSrest))/length(GSrest)
fcast33 <- vector(mode="list", length=length(GSrest))
fcastarim <- vector(mode="list", length=length(GSrest))
tmpmodel <- gs33_3g
arimamodel <- arim
for(i1 in 1:length(GSrest)) {
fcast33[[i1]] <- predict(tmpmodel, n_ahead=5, nsimu=1000, pi=0.95, pred_type="median",
pi_type="upper", plotRes=FALSE)
fcastarim[[i1]] <- forecast(arimamodel, h=5, level=0.95)
olddat <- tmpmodel$data
newdat <- c(olddat, GSrest[i1])
tmpmodel <- add_data(newdat, tmpmodel, calc_qresiduals=FALSE, calc_cond_moments=FALSE, calc_std_errors=FALSE)
arimamodel <- Arima(newdat, model=arimamodel)
print(i1)
}
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[1])
calc_mse <- function(pred) crossprod(exp(pred) - exp(GSrest))
calc_mse(fores33)
calc_mse(foresarim)
5340.733/5490.351
calc_mse <- function(pred) crossprod(exp(pred)[1:252] - exp(GSrest)[1:252])
calc_mse(fores33)
calc_mse(foresarim)
635.0805/640.5912
calc_mse <- function(pred) crossprod(exp(pred)[253:length(GSrest)] - exp(GSrest)[253:length(GSrest)])
calc_mse(fores33)
calc_mse(foresarim)
4705.652/4849.76
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[2])
calc_mse <- function(pred) crossprod(exp(pred)[-length(pred)][253:length(GSrest)] - exp(GSrest)[-1][253:length(GSrest)])
calc_mse(fores33)
length(GSrest)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-length(pred)][253:310] - exp(GSrest)[-1][253:310])
calc_mse(fores33)
calc_mse(foresarim)
6523.964/6673.225
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-length(pred)][1:252] - exp(GSrest)[-1][1:252])
calc_mse(fores33)
calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-length(pred)] - exp(GSrest)[-1])
calc_mse(fores33)
calc_mse(foresarim)
7536.683/7680.681
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[3])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[3])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(310, 311)] - exp(GSrest)[-c(1, 2)])
calc_mse(fores33)
calc_mse(foresarim)
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[4])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(309, 310, 311)] - exp(GSrest)[-c(1, 2, 3)])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[5])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim[[i1]]$mean[5])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)] - exp(GSrest)[-c(1, 2, 3, 4)])
calc_mse(fores33)/calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)][1:252] - exp(GSrest)[-c(1, 2, 3, 4)][1:252])
calc_mse(fores33)/calc_mse(foresarim)
ints33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred_ints[1])
sum(ints33 > GSrest)/length(GSrest)
ints33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred_ints[2])
sum(ints33[-311] > GSrest[-1])/length(GSrest)
ints33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred_ints[3])
sum(ints33[-c(310, 311)] > GSrest[-c(1, 2)])/length(GSrest)
ints33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred_ints[4])
sum(ints33[-c(309, 310, 311)] > GSrest[-c(1, 2, 3)])/length(GSrest)
ints33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred_ints[5])
sum(ints33[-c(308, 309, 310, 311)] > GSrest[-c(1, 2, 3, 4)])/length(GSrest)
plot(gs33_3g)
diagnosticPlot(gs33_3g)
gm33 <- fitGSMAR(GS, p=3, M=3, model="GMAR", ncalls=16, ncores=2, seeds=1:16)
gm33
plot(gm33)
diagnosticPlot(gm33)
gm33$AIC
gm33$IC
gs33_3g$IC
plot(gm33_3g)
plot(gs33_3g)
diagnosticPlot(gs33_g)
Q
Q
Q
Q
Q
Q
Q
Q
diagnosticPlot(gs33_3g)
gm33
save.image("/home/savi/Desktop/uGMARartikkeli/repro_env.gz")
tmpmodel <- gm33
gm33
fgm33 <- vector(mode="list", length=length(GSrest))
tmpmodel <- gm33
for(i1 in 1:length(GSrest)) {
fgm33[[i1]] <- predict(tmpmodel, n_ahead=5, nsimu=500, pi=0.95, pred_type="median",
pi_type="upper", plotRes=FALSE)
olddat <- tmpmodel$data
newdat <- c(olddat, GSrest[i1])
tmpmodel <- add_data(newdat, tmpmodel, calc_qresiduals=FALSE, calc_cond_moments=FALSE, calc_std_errors=FALSE)
print(i1)
}
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[5])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[5])
calc_mse(fores33)/calc_mse(forgm33)
Q
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[5])
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[5])
calc_mse(fores33)/calc_mse(forgm33)
Q
Q
Q
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)] - exp(GSrest)[-c(1, 2, 3, 4)])
calc_mse(fores33)/calc_mse(foregm33)
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[4])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(309, 310, 311)] - exp(GSrest)[-c(1, 2, 3)])
calc_mse(fores33)/calc_mse(foregm33)
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[3])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[3])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(310, 311)] - exp(GSrest)[-c(1, 2)])
calc_mse(fores33)/calc_mse(foregm33)
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[2])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(311)] - exp(GSrest)[-c(1)])
calc_mse(fores33)/calc_mse(foregm33)
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[1])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred) - exp(GSrest))
calc_mse(fores33)/calc_mse(foregm33)
arim
forecast::auto.arima(GS, d=0, seasonal=FALSE, stationary=TRUE, ic="aic",
stepwise=FALSE, approximation=FALSE, trace=TRUE,
max.p=10, max.q=10, max.order=20)
arim$aic
arim$aicc
arim2 <- Arima(GS, order=c(3, 0, 7), include.constant = TRUE, method="ML")
arim2
arim2 <- forecast::auto.arima(GS, d=0, seasonal=FALSE, stationary=TRUE, ic="aic",
stepwise=FALSE, approximation=FALSE, trace=TRUE,
max.p=10, max.q=10, max.order=12)
arim2
fcastarim2 <- vector(mode="list", length=length(GSrest))
arimamodel <- arim2
newdat <- GS
for(i1 in 1:length(GSrest)) {
fcastarim2[[i1]] <- forecast(arimamodel, h=5, level=0.95)
newdat <- c(newdat, GSrest[i1])
arimamodel <- Arima(newdat, model=arimamodel)
if(i1 %% 10 == 0) print(i1)
}
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[5])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[5])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[5])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[5])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)] - exp(GSrest)[-c(1, 2, 3, 4)])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[4])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(309, 310, 311)] - exp(GSrest)[-c(1, 2, 3)])
calc_mse(fores33)/calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(310, 311)] - exp(GSrest)[-c(1, 2)])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[2])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(311)] - exp(GSrest)[-c(2)])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[1])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred) - exp(GSrest))
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[1])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[1:252] - exp(GSrest)[1:252])
calc_mse(fores33)/calc_mse(foresarim)
length(SGrest)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[2])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(311)][1:252] - exp(GSrest)[-c(1)][1:252])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[3])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[3])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(310, 311)][1:252] - exp(GSrest)[-c(1, 2)][1:252])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[4])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(309, 310, 311)][1:252] - exp(GSrest)[-c(1, 2, 3)][1:252])
calc_mse(fores33)/calc_mse(foresarim)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[5])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[5])
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)][1:252] - exp(GSrest)[-c(1, 2, 3, 4)][1:252])
calc_mse(fores33)/calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)][253:311] - exp(GSrest)[-c(1, 2, 3, 4)][252:311])
calc_mse(fores33)/calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)][253:311] - exp(GSrest)[-c(1, 2, 3, 4)][253:311])
calc_mse(fores33)/calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)][253:307] - exp(GSrest)[-c(1, 2, 3, 4)][253:307])
calc_mse(fores33)/calc_mse(foresarim)
# length(GSrest) = 311
calc_mse <- function(pred) crossprod(exp(pred)[-c(308, 309, 310, 311)] - exp(GSrest)[-c(1, 2, 3, 4)])
calc_mse(fores33)/calc_mse(foresarim)
save.image("/home/savi/Desktop/uGMARartikkeli/repro_env.gz")
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[1])
calc_qlike <- function(pred) exp(GSrest)/exp(pred) - log(exp(GSrest)/exp(pred)) - 1
calc_qlike(fores33)/calc_qlike(foresarim)
calc_qlike <- function(pred) sum(exp(GSrest)/exp(pred) - log(exp(GSrest)/exp(pred)) - 1)
calc_qlike(fores33)/calc_qlike(foresarim)
calc_qlike <- function(pred, rest) sum(exp(rest)/exp(pred) - log(exp(rest)/exp(pred)) - 1)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[2])
length(fores33)
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[2])
calc_qlike(fores33[-c(311)], GSrest[-c(1)])/calc_qlike(foresarim[-c(311)], GSrest[-c(1)])
calc_qlike(fores33[-c(310, 311)], GSrest[-c(1, 2)])/calc_qlike(foresarim[-c(310, 311)], GSrest[-c(1, 2)])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[4])
calc_qlike(fores33[-c(309, 310, 311)], GSrest[-c(1, 2, 3)])/calc_qlike(foresarim[-c(309, 310, 311)],
GSrest[-c(1, 2, 3)])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[5])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[5])
calc_qlike(fores33[-c(308, 309, 310, 311)], GSrest[-c(1, 2, 3, 4)])/calc_qlike(foresarim[-c(308, 309, 310, 311)],
GSrest[-c(1, 2, 3, 4)])
calc_qlike(fores33[-c(308, 309, 310, 311)][1:252],
GSrest[-c(1, 2, 3, 4)][1:252])/calc_qlike(foresarim[-c(308, 309, 310, 311)][1:252],
GSrest[-c(1, 2, 3, 4)][1:252])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[4])
calc_qlike(fores33[-c(309, 310, 311)][1:252],
GSrest[-c(1, 2, 3)][1:252])/calc_qlike(foresarim[-c(308, 309, 310)][1:252],
GSrest[-c(1, 2, 3)][1:252])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[3])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[3])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[4])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[4])
calc_qlike(fores33[-c(309, 310, 311)][1:252],
GSrest[-c(1, 2, 3)][1:252])/calc_qlike(foresarim[-c(309, 310, 311)][1:252],
GSrest[-c(1, 2, 3)][1:252])
calc_qlike(fores33[-c(310, 311)][1:252],
GSrest[-c(1, 2)][1:252])/calc_qlike(foresarim[-c(310, 311)][1:252],
GSrest[-c(1, 2)][1:252])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[2])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[2])
calc_qlike(fores33[-c(311)][1:252],
GSrest[-c(1)][1:252])/calc_qlike(foresarim[-c(311)][1:252],
GSrest[-c(1)][1:252])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[1])
calc_qlike(fores33[1:252], GSrest[1:252])/calc_qlike(foresarim[1:252], GSrest[1:252])
calc_qlike(fores33[1:252], GSrest[1:252])/calc_qlike(foresarim[1:252], GSrest[1:252])
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[1])
calc_qlike(fores33[253:311], GSrest[253:311])/calc_qlike(foresarim[253:311], GSrest[253:311])
GSrest2 <- c(GS[length(GS)], GSrest[-length(GSrest)])
GSrest_plus <- c(GS[length(GS)], GSrest)
GSrest2 <- c(GS[length(GS)], GSrest[-length(GSrest)])
signs <- GSrest2 - GSrest
signs
GSrest - GSrest2
increased <- sum(GSrest - GSrest2 > 0)
increased <- GSrest - GSrest2 > 0
inceased
increased <- GSrest - GSrest2 > 0
increased
fores33 <- sapply(1:length(GSrest), function(i1) fcast33[[i1]]$pred[1])
foresarim <- sapply(1:length(GSrest), function(i1) fcastarim2[[i1]]$mean[1])
increased33 <- fores33 - GSrest2 > 0
increased == increased33
sum(increased == increased33)/311
increasedarim <- foresarim - GSrest2 > 0
sum(increased == increasedarim)/311
foregm33 <- sapply(1:length(GSrest), function(i1) fgm33[[i1]]$pred[5])
increased33 <- foregm33 - GSrest2 > 0
sum(increased == increased33)/311
increased33 <- fores33 - GSrest2 > 0
sum(increased == increased33)/311
sum(increased == increasedarim)/311
sum(increased[1:252] == increased33[1:252])/252 # Suunnan vaihto oikein tässä osuudessa
sum(increased[1:252] == increasedarim)[1:252/252
sum(increased[1:252] == increasedarim)[1:252/252]
sum(increased[1:252] == increasedarim)[1:252/252]
sum(increased[1:252] == increasedarim)[1:252]/252
sum(increased[1:252] == increased33[1:252])/252 # Suunnan vaihto oikein tässä osuudessa
sum(increased[1:252] == increasedarim[1:252])/252
length(253:311)
sum(increased[253:311] == increased33[253:311])/59 # Suunnan vaihto oikein tässä osuudessa
sum(increased[253:311] == increasedarim[253:311])/59
sum(increased == increasedarim)/311
sum(increased == increased33)/311 # Suunnan vaihto oikein tässä osuudessa
